{% extends "core/base.html" %}
{% load static %}

{% block title %}Login{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block content %}
<div class="login-wrapper center">
  <section class="login-card card enter" aria-labelledby="login-title">
    <img class="avatar" src="{% static 'img/logo2.jpeg' %}" alt="Logo institucional" width="104" height="104">

    <h1 id="login-title" class="login-title text-xl">MILLENNIALS</h1>

    <form class="login-form" action="{% url 'login' %}" method="post" novalidate>
      {% csrf_token %}
      {% if next %}
        <input type="hidden" name="next" value="{{ next }}">
      {% endif %}

      {% if error %}
        <p id="login-error" class="error-message" role="alert" aria-live="assertive">{{ error }}</p>
      {% endif %}

      <label for="usuario" class="field-label">Usuario</label>
      <input id="usuario" name="usuario" type="text"
             class="field-control input"
             placeholder="Usuario"
             autocomplete="username" required
             {% if error %}aria-invalid="true" aria-describedby="login-error"{% endif %}>

      <label for="password" class="field-label">Contraseña</label>
      <span class="field-wrap">
        <input id="password" name="password" type="password"
               class="field-control input"
               placeholder="Contraseña"
               autocomplete="current-password" required
               {% if error %}aria-invalid="true" aria-describedby="login-error"{% endif %}>
        <!-- Botón ojo con SVG inline (JS propio mantiene data-visible) -->
        <button type="button" class="toggle-pass"
                aria-label="Mostrar u ocultar contraseña"
                aria-pressed="false"
                data-visible="false">
          <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 5c5 0 9 3.5 11 7-2 3.5-6 7-11 7S3 15.5 1 12c2-3.5 6-7 11-7Zm0 2C8.5 7 5.7 9.2 4.1 12 5.7 14.8 8.5 17 12 17s6.3-2.2 7.9-5C18.3 9.2 15.5 7 12 7Zm0 2.5A2.5 2.5 0 1 1 9.5 12 2.5 2.5 0 0 1 12 9.5Z"/>
          </svg>
        </button>
      </span>

      <button type="submit" class="btn btn--danger btn-login">Entrar</button>
      <a class="forgot" href="#" tabindex="0">¿Olvidaste tu contraseña?</a>
    </form>
  </section>
</div>
{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/login.js' %}" defer></script>
  <script>
    // Evita “pantalla en blanco” al volver con el botón atrás (revalida la vista)
    window.addEventListener('pageshow', function (e) {
      if (e.persisted) location.reload();
    });
  </script>
{% endblock %}
